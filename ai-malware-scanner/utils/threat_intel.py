import requests

def query_threat_intel(file_hash):
    # VirusTotal API v3 endpoint for file reports
    api_key = "c30f733c381a4f0e456b54f5ea67b28a85b55ce00e39999778c1c41bbed21139"  # Replace with your actual VirusTotal API key
    url = f"https://www.virustotal.com/api/v3/files/{file_hash}"
    headers = {"x-apikey": api_key}
    
    try:
        response = requests.get(url, headers=headers)
        if response.status_code == 200:
            # Return the complete JSON response from VirusTotal
            return response.json()
        else:
            return {"error": f"VirusTotal API error: {response.status_code}, {response.text}"}
    except Exception as e:
        return {"error": str(e)}
